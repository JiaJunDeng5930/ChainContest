# packages/db TODOs

- [ ] commit TODO: Setup scaffolding ready for atomic commit
  - 包含文件：`pnpm-workspace.yaml`、根 `package.json`、`packages/db` scaffolding（package.json、tsconfig、vitest、drizzle、README、.env.sample、src/index.ts）
  - 验证：`pnpm install`、`pnpm db:test`（待实现测试时启用）
- [ ] commit TODO: Foundational utilities ready for commit
  - 依赖任务：T006、T007、T008、T009
  - 包含文件：`src/adapters/connection.ts`、`src/instrumentation/metrics.ts`、`src/bootstrap/register-validators.ts`、`tests/fixtures/*`、`tests/setup/vitest.setup.ts`、`vitest.config.ts`
  - 验证：`pnpm db:test`（需提供本地 PostgreSQL `DATABASE_URL`）
- [ ] commit TODO: US1 lookup ready for commit
  - 依赖任务：T011、T012、T013、T014
  - 包含文件：`src/schema/user-bindings.ts`、`src/repositories/userWalletLookup.ts`、`src/index.ts`、`tests/contract/userWalletLookup.test.ts`、`migrations/0001_user_bindings.sql`
  - 验证：`pnpm db:test -- --runInBand tests/contract/userWalletLookup.test.ts`
- [ ] commit TODO: US2 mutations ready for commit
  - 依赖任务：T016、T017、T018、T019、T020
  - 包含文件：`src/schema/user-bindings.ts`、`migrations/0002_wallet_binding_audit.sql`、`src/repositories/userWalletMutations.ts`、`src/index.ts`、`tests/contract/userWalletMutations.test.ts`、`tests/helpers/validators.ts`
  - 验证：`pnpm --filter @chaincontest/db test -- --runInBand tests/contract/userWalletMutations.test.ts`
- [ ] commit TODO: US3 contest views ready for commit
  - 依赖任务：T021、T022、T023、T024、T025
  - 包含文件：`src/schema/contest-domain.ts`、`migrations/0003_contest_domain.sql`、`src/repositories/contestQueries.ts`、`src/index.ts`、`tests/contract/contestQueries.test.ts`、`tests/helpers/validators.ts`
  - 验证：`pnpm --filter @chaincontest/db test -- tests/contract/contestQueries.test.ts`
- [ ] commit TODO: US4 ingestion ready for commit
  - 依赖任务：T026、T027、T028、T029、T030
  - 包含文件：`src/schema/ingestion.ts`、`migrations/0004_ingestion.sql`、`src/repositories/contestDomainWrites.ts`、`src/index.ts`、`tests/contract/contestDomainWrites.test.ts`、`tests/contract/ingestionProgress.test.ts`、`tests/helpers/validators.ts`
  - 验证：`pnpm --filter @chaincontest/db test -- tests/contract/contestDomainWrites.test.ts tests/contract/ingestionProgress.test.ts`
- [ ] commit TODO: Release polish ready for final commit
  - 依赖任务：T031、T032、T033
  - 包含文件：`specs/007-implement-db-module/quickstart.md`、`packages/db/README.md`、`src/instrumentation/metrics.ts`、`src/index.ts`
  - 验证：`pnpm --filter @chaincontest/db test`
